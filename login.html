<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home</title>
  <link rel="stylesheet" href="./theme/plugin/bootstrap-5.0.2-dist/css/bootstrap.css" />
  <link rel="stylesheet" href="./theme/plugin/icons-1.10.4/font/bootstrap-icons.css" />
  <link rel="stylesheet" href="./theme/plugin/themify-icons-font/themify-icons.css">
  <link rel="stylesheet" href="./theme/user_theme/css/alter.css" />
  <link rel="stylesheet" href="./theme/user_theme/css/template.css" />
  <link rel="stylesheet" href="./theme/user_theme/css/app.css" />
</head>

<body class="page-login" style="background-image:
    url('./uploads/background_login.png')">
  <div class="wrapper">
    <div class="wrapper-container">
      <div id="preloader">
        <div class="spinner-border" role="status" style="background-image:
            url('./uploads/logo/logo-preload.svg');">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>
      <div class="block-login row">
        <div class="login-left">
          <img src="./uploads/logo/logo-white-432x105.png" alt="Logo EI
              Germeny" class="img-fluid" />
        </div>
        <div class="login-right">
          <form action="" id="signin-form" class="open-form" onsubmit="checkAcc(event,'#signin-form')">
            <div class="login-top">
              <a href="./index.html" class="btn btn-back">
                <img src="./theme/user_theme/icon/left-arrow-0.png" alt="" class="icon-back" />Đăng nhập</a>
            </div>
            <div class="login-middle">
              <img src="./uploads/logo/logo-full-428x104.png" alt="Logo EI
                  Germeny" class="img-fluid" />
              <p class="edit-text">Chào mừng bạn đã đến với EI Germany!</p>
            </div>
            <div class="login-middle-after">
              <div class="login-form">
                <!-- Email/phone input -->
                <div class="form-outline mb-4">
                  <div class="div-input">
                    <span class="icon ti-email"></span>
                    <input type="text" id="formAccount" class="form-control" placeholder="Email/Số điện thoại"
                      name="account" autofocus required />
                  </div>
                </div>
                <!-- Password input -->
                <div class="form-outline mb-4">
                  <div class="div-input">
                    <span class="icon ti-lock"></span>
                    <input type="password" id="formPassword" class="form-control" placeholder="Mật khẩu" name="password"
                      required />
                    <img src="./theme/user_theme/icon/eye-close.svg" alt="">
                    <span class="btn-showpass"><i class="bi bi-eye-slash"></i></span>
                  </div>
                </div>
                <!-- Submit button -->
                <button type="submit" class="btn btn-login mb-4">Đăng nhập</button>
                <div class="text-center forgot-password">
                  <!-- Forgot password buttons -->
                  <p><a onclick="ShowHide('#signin-form','#forgot-password-form')" class="forgot-password-link">Quên mật
                      khẩu?</a></p>
                  <!-- Register buttons -->
                  <p>Chưa có tài khoản?<a onclick="ShowHide('#signin-form','#register-form')"
                      class="forgot-password-link"> Đăng ký</a></p>
                </div>
              </div>
            </div>
          </form>
          <form action="" id="forgot-password-form" style="display: none;">
            <div class="login-top">
              <a onclick="ShowHide('#signin-form','#forgot-password-form')" class="btn btn-back">
                <img src="./theme/user_theme/icon/left-arrow-0.png" alt="" class="icon-back" />Quên mật khẩu</a>
            </div>
            <div class="login-middle">
              <img src="./uploads/logo/logo-full-428x104.png" alt="Logo EI
                  Germeny" class="img-fluid" />
              <p class="edit-text">Hãy nhập email của bạn để bắt đầu lấy lại
                mật khẩu.</p>
            </div>
            <div class="forgot-password-form">
              <!-- Email/phone input -->
              <div class="form-outline mb-4">
                <div class="div-input">
                  <span class="icon ti-email"></span>
                  <input type="email" id="forgotAccount" class="form-control" placeholder="Email" required />
                </div>
              </div>
              <!-- Submit button -->
              <!-- <button type="button" class="btn btn-login mb-4">Tiếp tục</button> -->
              <a type="button" class="btn btn-login mb-4" href="./otp.html">Tiếp
                tục</a>
            </div>
          </form>
          <form action="" id="register-form" style="display: none;" onsubmit="validateForm(event,'#register-form')">
            <div class="login-top">
              <a onclick="ShowHide('#signin-form','#register-form')" class="btn btn-back">
                <img src="./theme/user_theme/icon/left-arrow-0.png" alt="" class="icon-back" />Đăng ký</a>
            </div>
            <div class="login-middle">
              <img src="./uploads/logo/logo-full-428x104.png" alt="Logo EI
                  Germeny" class="img-fluid" />
              <p class="edit-text">Chào mừng bạn đã đến với EI Germany!</p>
            </div>
            <div class="register-form">
              <!-- Name input -->
              <div class="form-outline mb-4">
                <div class="div-input">
                  <span class="icon"><i class="bi bi-person"></i></span>
                  <input type="text" id="registerName" class="form-control" placeholder="Ex: Nguyễn Văn A"
                    name="fullname" />
                </div>
              </div><!-- Email input -->
              <div class="form-outline mb-4">
                <div class="div-input">
                  <span class="icon-email ti-email"></span>
                  <input type="email" id="registerEmail" class="form-control" placeholder="Ex:abc@gmail.com"
                    name="email" />
                </div>
              </div>
              <!--Phone input -->
              <div class="form-outline mb-4">
                <div class="div-input">
                  <span class="icon"><i class="bi bi-telephone"></i> </span>
                  <input type="tel" id="registerPhone" class="form-control" placeholder="Ex:+8433445506" name="phone" />
                </div>
              </div>
              <!-- Password input -->
              <div class="form-outline mb-4">
                <div class="div-input">
                  <span class="icon ti-lock"></span>
                  <input type="password" id="registerPassword" class="form-control" placeholder="Mật khẩu"
                    name="password" />
                  <span class="btn-showpass"><i class="bi bi-eye-slash"></i></span>
                </div>
              </div>
              <!-- Repeat Password input -->
              <div class="form-outline mb-4">
                <div class="div-input">
                  <span class="icon ti-lock"></span>
                  <input type="password" id="registerRepeatPassword" class="form-control"
                    placeholder="Nhập lại mật khẩu" name="re_password" />
                  <img src="./theme/user_theme/icon/eye-close.svg" alt="">
                  <span class="btn-showpass"><i class="bi bi-eye-slash"></i></span>
                </div>
              </div>
              <!-- Submit button -->
              <button type="Submit" class="btn btn-login mb-4">Đăng ký</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</body>
<script src="theme/plugin/jquery-3.6.4.min.js"></script>
<script src="theme/plugin/bootstrap-5.0.2-dist/js/bootstrap.js"></script>
<script src="theme/user_theme/javascript/app.js"></script>
<script>
  function ShowHide(id_form1, id_form2) {
    let form1 = $(id_form1);
    let form2 = $(id_form2);
    form1.toggle();
    form2.toggle();
    form1.toggleClass('open-form');
    form2.toggleClass('open-form');
    if (form1.hasClass('open-form')) {
      form1.find('input:first').focus();
    } else {
      form2.find('input:first').focus();
    }
  }

  // SaveAcc
  function saveAcc(id_form) {
    var user = {
      fullname: '',
      email: '',
      phone: '',
      password: '',
      re_password: ''
    }
    $(id_form).find('input').each(function () {
      var input = $(this); // This is the jquery object of the input, do what you will
      let name = input.attr('name');
      let val = input.val();
      Object.keys(user)
        .forEach(function eachKey(key) {
          // console.log(key + '-' + user[key]); //key + value
          if (name == key) {
            user[key] = val;
          }
        });
    });
    //save data to localStorage
    localStorage.setItem('USER_INFO', JSON.stringify(user));
    return true;
  }

  // Check form submit
  function validateForm(e, id_form) {
    e.preventDefault();// chặn hoạt động mặc định của form
    // xử lý form
    // Validate lowercase letters
    let lowerCaseLetters = /[a-z]/g;
    // Validate capital letters
    let upperCaseLetters = /[A-Z]/g;
    // Validate numbers
    var numbers = /[0-9]/g;
    // Validate phone
    var phoneformat = /(0[3|5|7|8|9])+([0-9]{8})|(\+84)+([0-9]{9})\b/;
    // Validate email
    let mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
    let check_number = 0;
    $(id_form).find('input').each(function () {
      var input = $(this); // This is the jquery object of the input, do what you will
      let type = input.attr('type');
      let name = input.attr('name');
      let val = input.val();
      switch (type) {
        case 'email':
          // code block
          if (val.length == 0) {
            alert("Vui lòng nhập Email!");
            check_number = 1;
            input.val('');
            return false;
          }
          if (!mailformat.test(val)) {
            alert("Email không đúng đinh dạnh!");
            check_number = 1;
            input.val('');
            return false;
          }
          break;
        case 'password':
          // code block
          if (name == 're_password') {
            if (val.length == 0) {
              alert("Vui lòng nhập xác nhận mật khẩu!");
              check_number = 1;
              input.val('');
              return false;
            }
            // Validate Password/RePassword
            if (val == input.siblings('input[name="password"]').val()) {
              alert("Mật khẩu xác nhận không giống!");
              check_number = 1;
              input.val('');
              return false;
            }
          }
          else
            if (val.length == 0) {
              alert("Vui lòng nhập mật khẩu!");
              check_number = 1;
              input.val('');
              return false;
            }
          break;
        case 'text':
          if (name == 'fullname') {
            if (val.length == 0) {
              alert("Vui lòng nhập tên của bạn!");
              check_number = 1;
              input.val('');
              return false;
            }
          }
          break;
        case 'tel':
          if (val.length == 0) {
            alert("Vui lòng nhập số điện thoại của bạn!");
            check_number = 1;
            input.val('');
            return false;
          }
          if (!phoneformat.test(val)) {
            alert("Số điện thoại không đúng đinh dạnh!");
            check_number = 1;
            input.val('');
            return false;
          }
          break;
        // default:
        // code block
      }
    });
    if (check_number == 0) {
      if (saveAcc(id_form)) {
        alert('Tạo tài khoản thành công.');
      } else {
        alert('Có lỗi xảy ra. Vui lòng liên hệ tổng đài.');
      }
    }
  }

  function checkAcc(e, id_form) {
    e.preventDefault();// chặn hoạt động mặc định của form
    // xử lý form
    let acc = $(id_form).find('input[id="formAccount"]').val();
    let pass = $(id_form).find('input[id="formPassword"]').val();
    //Get data from localStorage
    let data = JSON.parse(localStorage.getItem('USER_INFO'));
    if (acc == data['phone'] || acc == data['email']) {
      if (pass == data['password']) {
        //save data to localStorage
        sessionStorage.setItem('USER_INFO', JSON.stringify(data));
        window.location.replace("home.html");
      } else {
        alert('Mật khẩu không chính xác!');
      }
    } else {
      alert('Không tìm thấy tài khoản này!');
    }
  }
  (function ($) {
    $('.btn-showpass').click(function (e) {
      e.preventDefault();
      if ($(this).siblings('input').attr('type') == 'password') {
        $(this).siblings('input[type="password"]').attr('type', 'text');
      } else {
        $(this).siblings('input[type="text"]').attr('type', 'password');
      }
      $(this).find('i').toggleClass('bi-eye');
      $(this).find('i').toggleClass('bi-eye-slash');
    });

  })(window.jQuery);
</script>
<!-- user.push({ input.name(): input.val() }); -->

</html>